<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 3 - Lesson 4: Suspicious Attachments - PhishGuard.uz</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #2563eb;
            --primary-blue-dark: #1d4ed8;
            --bg-gradient-start: #3b82f6;
            --bg-gradient-end: #2563eb;
            --text-dark: #1e293b;
            --text-muted: #64748b;
            --bg-white: #ffffff;
            --bg-light: #f1f5f9;
            --border-color: #e2e8f0;
            --error-red: #dc2626;
            --success-green: #16a34a;
            --warning-yellow: #f59e0b;
            --cyan: #06b6d4;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(37,99,235,0.12);
            --shadow-lg: 0 20px 40px rgba(37,99,235,0.15);
        }

        body {
            font-family: 'Manrope', sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            color: var(--text-dark);
            position: relative;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255,255,255,0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .page-container {
            position: relative;
            z-index: 1;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .lang-switch {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 8px;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            padding: 6px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .lang-btn {
            padding: 8px 16px;
            background: transparent;
            border: none;
            border-radius: 8px;
            color: white;
            font-family: 'Manrope', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lang-btn.active {
            background: white;
            color: var(--primary-blue);
            box-shadow: var(--shadow-sm);
        }

        .lang-btn:hover:not(.active) {
            background: rgba(255,255,255,0.15);
        }

        /* Header */
        .module-header {
            background: white;
            border-radius: 20px;
            padding: 32px 40px;
            box-shadow: var(--shadow-md);
            margin-bottom: 24px;
            animation: slideDown 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .module-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, var(--cyan), #22d3ee);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .module-title {
            font-size: 32px;
            font-weight: 800;
            color: var(--text-dark);
            margin-bottom: 12px;
            letter-spacing: -0.5px;
        }

        .module-subtitle {
            font-size: 16px;
            color: var(--text-muted);
            line-height: 1.6;
        }

        /* Progress Bar */
        .progress-container {
            background: white;
            border-radius: 16px;
            padding: 20px 24px;
            box-shadow: var(--shadow-md);
            margin-bottom: 24px;
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-text {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .progress-percentage {
            font-size: 14px;
            font-weight: 700;
            color: var(--primary-blue);
        }

        .progress-bar {
            background: var(--bg-light);
            height: 8px;
            border-radius: 8px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--cyan), #22d3ee);
            width: 0%;
            transition: width 0.6s ease;
            border-radius: 8px;
        }

        /* Lesson Content */
        .lesson-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--shadow-md);
            margin-bottom: 24px;
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.2s backwards;
        }

        .lesson-section {
            margin-bottom: 40px;
        }

        .lesson-section:last-child {
            margin-bottom: 0;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--cyan), #22d3ee);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .section-content {
            font-size: 16px;
            line-height: 1.8;
            color: var(--text-dark);
            margin-bottom: 20px;
        }

        .section-content strong {
            color: var(--cyan);
        }

        .file-types-list {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }

        .file-types-list li {
            padding: 16px 20px;
            background: linear-gradient(135deg, #ecfeff, #cffafe);
            border-left: 4px solid var(--cyan);
            border-radius: 12px;
            margin-bottom: 12px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            font-size: 15px;
            line-height: 1.6;
        }

        .file-types-list li::before {
            flex-shrink: 0;
            font-size: 20px;
        }

        .file-types-list li:nth-child(1)::before { content: 'üì±'; }
        .file-types-list li:nth-child(2)::before { content: 'üíª'; }
        .file-types-list li:nth-child(3)::before { content: 'üß©'; }
        .file-types-list li:nth-child(4)::before { content: 'üìÑ'; }

        .file-types-list li strong {
            color: #155e75;
            font-family: 'Courier New', monospace;
        }

        .safe-note {
            background: #dcfce7;
            border-left: 4px solid var(--success-green);
            padding: 16px 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .safe-note strong {
            color: var(--success-green);
        }

        /* Scenario Section */
        .scenario-section {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-radius: 16px;
            padding: 32px;
            margin-top: 40px;
        }

        .scenario-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 22px;
            font-weight: 700;
            color: #92400e;
            margin-bottom: 16px;
        }

        .scenario-description {
            color: #78350f;
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .scenario-email {
            background: white;
            padding: 16px;
            border-radius: 10px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-sm);
        }

        .scenario-email strong {
            color: var(--text-dark);
        }

        .attachment-box {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: var(--shadow-sm);
        }

        .attachment-label {
            font-size: 15px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 12px;
        }

        .attachment-file {
            font-size: 15px;
            color: var(--cyan);
            margin-bottom: 16px;
            padding: 12px;
            background: var(--bg-light);
            border-radius: 8px;
            font-family: 'Courier New', monospace;
        }

        .attachment-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .attachment-btn {
            flex: 1;
            min-width: 120px;
            padding: 12px 20px;
            border: 2px solid transparent;
            border-radius: 10px;
            font-family: 'Manrope', sans-serif;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .attachment-btn.safe {
            background: white;
            border-color: var(--success-green);
            color: var(--success-green);
        }

        .attachment-btn.safe:hover:not(.disabled) {
            background: var(--success-green);
            color: white;
            transform: translateY(-2px);
        }

        .attachment-btn.unsafe {
            background: white;
            border-color: var(--error-red);
            color: var(--error-red);
        }

        .attachment-btn.unsafe:hover:not(.disabled) {
            background: var(--error-red);
            color: white;
            transform: translateY(-2px);
        }

        .attachment-btn.disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }

        .feedback {
            margin-top: 12px;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            display: none;
        }

        .feedback.show {
            display: block;
            animation: slideDown 0.4s ease;
        }

        .feedback.correct {
            background: #dcfce7;
            color: var(--success-green);
        }

        .feedback.incorrect {
            background: #fee2e2;
            color: var(--error-red);
        }

        /* Navigation */
        .navigation {
            display: flex;
            justify-content: space-between;
            gap: 16px;
            margin-top: 32px;
        }

        .nav-btn {
            flex: 1;
            max-width: 200px;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-family: 'Manrope', sans-serif;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
        }

        .nav-btn-prev {
            background: var(--bg-light);
            color: var(--text-dark);
        }

        .nav-btn-prev:hover {
            background: #e2e8f0;
            transform: translateX(-4px);
        }

        .nav-btn-next {
            background: var(--cyan);
            color: white;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3);
        }

        .nav-btn-next:hover {
            background: #0891b2;
            transform: translateX(4px);
            box-shadow: 0 6px 20px rgba(6, 182, 212, 0.4);
        }

        @media (max-width: 768px) {
            .page-container {
                padding: 16px;
            }

            .module-header {
                padding: 24px;
            }

            .module-title {
                font-size: 24px;
            }

            .lesson-content {
                padding: 24px;
            }

            .scenario-section {
                padding: 24px;
            }

            .navigation {
                flex-direction: column;
            }

            .nav-btn {
                max-width: 100%;
            }

            .attachment-buttons {
                flex-direction: column;
            }

            .attachment-btn {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>

            <a href="{{ url_for('home') }}" class="btn" style="position: fixed; top: 20px; left: 20px; z-index: 1000; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); color: white; padding: 12px 20px; text-decoration: none; border-radius: 12px; display: flex; align-items: center; gap: 8px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                <span>Home</span>
            </a>
    <!-- Language Switch -->
    <div class="lang-switch">
        <button class="lang-btn active" data-lang="en">English</button>
        <button class="lang-btn" data-lang="uz">O'zbek</button>
    </div>

    <div class="page-container">
        <!-- Module Header -->
        <div class="module-header">
            <div class="module-badge">
                <span>üìé</span>
                <span data-translate="module-badge">Module 3 - Lesson 4</span>
            </div>
            <h1 class="module-title" data-translate="module-title">Suspicious attachments and files</h1>
            <p class="module-subtitle" data-translate="module-subtitle">
                Learn to identify dangerous file types and handle email attachments safely
            </p>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-label">
                <span class="progress-text" data-translate="progress-text">Lesson progress</span>
                <span class="progress-percentage" id="progressPercentage">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <!-- Lesson Content -->
        <div class="lesson-content">
            <!-- What Makes an Attachment Dangerous -->
            <div class="lesson-section">
                <h2 class="section-title">
                    <span class="section-icon">üìñ</span>
                    <span data-translate="dangerous-title">What makes an attachment dangerous?</span>
                </h2>
                <p class="section-content" data-translate="dangerous-text">
                    Cybercriminals often send attachments that look harmless but contain hidden malware. These can install spyware, steal login credentials, or encrypt files for ransom. The danger often lies in file types that can execute code on your device.
                </p>
            </div>

            <!-- File Types to Watch Out For -->
            <div class="lesson-section">
                <h2 class="section-title">
                    <span class="section-icon">‚ö†Ô∏è</span>
                    <span data-translate="filetypes-title">File types to watch out for</span>
                </h2>

                <ul class="file-types-list">
                    <li>
                        <span><strong data-translate="filetype1-name">.apk</strong> ‚Äî <span data-translate="filetype1-desc">Android app installers (can contain malware).</span></span>
                    </li>
                    <li>
                        <span><strong data-translate="filetype2-name">.exe</strong> ‚Äî <span data-translate="filetype2-desc">Windows executable programs (high-risk).</span></span>
                    </li>
                    <li>
                        <span><strong data-translate="filetype3-name">.scr</strong> ‚Äî <span data-translate="filetype3-desc">Screensaver files that act as hidden executables.</span></span>
                    </li>
                    <li>
                        <span><strong data-translate="filetype4-name">.docm</strong> ‚Äî <span data-translate="filetype4-desc">Word files with macros that can execute scripts.</span></span>
                    </li>
                </ul>

                <div class="safe-note">
                    <p data-translate="safe-note">
                        By contrast, files like <strong>.pdf</strong> or <strong>.png</strong> are generally safer ‚Äî but only when previewed inside your email client or online viewer, not downloaded directly.
                    </p>
                </div>
            </div>

            <!-- Why Previewing PDFs Is Safer -->
            <div class="lesson-section">
                <h2 class="section-title">
                    <span class="section-icon">üîí</span>
                    <span data-translate="preview-title">Why previewing PDFs is safer</span>
                </h2>
                <p class="section-content" data-translate="preview-text">
                    When you preview a PDF in your browser or email viewer, the file is sandboxed ‚Äî meaning it runs in a protected environment. Downloading and opening files locally gives them more access to your system, which attackers can exploit.
                </p>
            </div>

            <!-- Interactive Scenario -->
            <div class="scenario-section">
                <div class="scenario-title">
                    <span>üß™</span>
                    <span data-translate="scenario-title">Interactive scenario: choose wisely</span>
                </div>
                <p class="scenario-description" data-translate="scenario-description">
                    You've received an email titled:
                </p>
                <div class="scenario-email">
                    <strong data-translate="email-title">"Important: Account Verification Required"</strong>
                </div>
                <p class="scenario-description" data-translate="scenario-question">
                    It contains three attachments. Which action would you take for each?
                </p>

                <!-- Attachment 1 -->
                <div class="attachment-box" id="att1">
                    <p class="attachment-label" data-translate="att1-label">Attachment 1:</p>
                    <div class="attachment-file">Verification_Form.docm</div>
                    <div class="attachment-buttons">
                        <button class="attachment-btn unsafe" onclick="checkAttachment(1, false)" data-translate="att1-unsafe">
                            Open
                        </button>
                        <button class="attachment-btn safe" onclick="checkAttachment(1, true)" data-translate="att1-safe">
                            Avoid
                        </button>
                    </div>
                    <div class="feedback" id="feedback1"></div>
                </div>

                <!-- Attachment 2 -->
                <div class="attachment-box" id="att2">
                    <p class="attachment-label" data-translate="att2-label">Attachment 2:</p>
                    <div class="attachment-file">Account_Info.pdf</div>
                    <div class="attachment-buttons">
                        <button class="attachment-btn safe" onclick="checkAttachment(2, true)" data-translate="att2-safe">
                            Preview only
                        </button>
                        <button class="attachment-btn unsafe" onclick="checkAttachment(2, false)" data-translate="att2-unsafe">
                            Download
                        </button>
                    </div>
                    <div class="feedback" id="feedback2"></div>
                </div>

                <!-- Attachment 3 -->
                <div class="attachment-box" id="att3">
                    <p class="attachment-label" data-translate="att3-label">Attachment 3:</p>
                    <div class="attachment-file">UpdateApp.apk</div>
                    <div class="attachment-buttons">
                        <button class="attachment-btn unsafe" onclick="checkAttachment(3, false)" data-translate="att3-unsafe">
                            Install
                        </button>
                        <button class="attachment-btn safe" onclick="checkAttachment(3, true)" data-translate="att3-safe">
                            Delete immediately
                        </button>
                    </div>
                    <div class="feedback" id="feedback3"></div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="navigation">
                <a href="{{ url_for('lesson', module=3, lesson=3) }}" class="nav-btn nav-btn-prev">
                    <span>‚¨ÖÔ∏è</span>
                    <span data-translate="btn-prev">Previous lesson</span>
                </a>
                <a href="{{ url_for('lesson', module=3, lesson=5) }}" class="nav-btn nav-btn-next">
                    <span data-translate="btn-next">Next lesson</span>
                    <span>‚û°Ô∏è</span>
                </a>
            </div>
        </div>
    </div>

    <script>
        // Translations
        const translations = {
            en: {
                'module-badge': 'Module 3 - Lesson 4',
                'module-title': 'Suspicious attachments and files',
                'module-subtitle': 'Learn to identify dangerous file types and handle email attachments safely',
                'progress-text': 'Lesson progress',
                'dangerous-title': 'What makes an attachment dangerous?',
                'dangerous-text': 'Cybercriminals often send attachments that look harmless but contain hidden malware. These can install spyware, steal login credentials, or encrypt files for ransom. The danger often lies in file types that can execute code on your device.',
                'filetypes-title': 'File types to watch out for',
                'filetype1-name': '.apk',
                'filetype1-desc': 'Android app installers (can contain malware).',
                'filetype2-name': '.exe',
                'filetype2-desc': 'Windows executable programs (high-risk).',
                'filetype3-name': '.scr',
                'filetype3-desc': 'Screensaver files that act as hidden executables.',
                'filetype4-name': '.docm',
                'filetype4-desc': 'Word files with macros that can execute scripts.',
                'safe-note': 'By contrast, files like .pdf or .png are generally safer ‚Äî but only when previewed inside your email client or online viewer, not downloaded directly.',
                'preview-title': 'Why previewing PDFs is safer',
                'preview-text': 'When you preview a PDF in your browser or email viewer, the file is sandboxed ‚Äî meaning it runs in a protected environment. Downloading and opening files locally gives them more access to your system, which attackers can exploit.',
                'scenario-title': 'Interactive scenario: choose wisely',
                'scenario-description': 'You\'ve received an email titled:',
                'email-title': '"Important: Account Verification Required"',
                'scenario-question': 'It contains three attachments. Which action would you take for each?',
                'att1-label': 'Attachment 1:',
                'att1-unsafe': 'Open',
                'att1-safe': 'Avoid',
                'att2-label': 'Attachment 2:',
                'att2-safe': 'Preview only',
                'att2-unsafe': 'Download',
                'att3-label': 'Attachment 3:',
                'att3-unsafe': 'Install',
                'att3-safe': 'Delete immediately',
                'btn-prev': 'Previous lesson',
                'btn-next': 'Next lesson',
                'feedback-safe': '‚úÖ Good choice! Always verify and preview attachments safely before opening.',
                'feedback-unsafe': '‚ö†Ô∏è Unsafe! This file could contain malware or phishing content. Never open suspicious attachments.'
            },
            uz: {
                'module-badge': '3-modul - 4-dars',
                'module-title': 'Shubhali qo\'shimchalar va fayllar',
                'module-subtitle': 'Xavfli fayl turlarini aniqlashni va elektron pochta qo\'shimchalarini xavfsiz boshqarishni o\'rganing',
                'progress-text': 'Dars jarayoni',
                'dangerous-title': 'Qo\'shimchani nimasi xavfli qiladi?',
                'dangerous-text': 'Kiberjinoyatchilar ko\'pincha zararsiz ko\'rinadigan, lekin yashirin zararli dasturlarga ega qo\'shimchalarni yuborishadi. Bular josuslik dasturlarini o\'rnatishi, kirish ma\'lumotlarini o\'g\'irlashi yoki fayllarni to\'lov uchun shifrlashi mumkin. Xavf ko\'pincha qurilmangizda kodni bajaradigan fayl turlarida yotadi.',
                'filetypes-title': 'Ehtiyot bo\'lish kerak bo\'lgan fayl turlari',
                'filetype1-name': '.apk',
                'filetype1-desc': 'Android ilova o\'rnatuvchilari (zararli dastur bo\'lishi mumkin).',
                'filetype2-name': '.exe',
                'filetype2-desc': 'Windows bajariladigan dasturlar (yuqori xavfli).',
                'filetype3-name': '.scr',
                'filetype3-desc': 'Yashirin bajariladigan fayllar sifatida ishlaydigan ekran himoyasi fayllari.',
                'filetype4-name': '.docm',
                'filetype4-desc': 'Skriptlarni bajara oladigan makroslarga ega Word fayllari.',
                'safe-note': 'Aksincha, .pdf yoki .png kabi fayllar odatda xavfsizroq ‚Äî lekin faqat elektron pochta mijozingiz yoki onlayn ko\'ruvchida oldindan ko\'rilganda, to\'g\'ridan-to\'g\'ri yuklab olinmaganda.',
                'preview-title': 'PDF ni oldindan ko\'rish nega xavfsizroq',
                'preview-text': 'PDF ni brauzer yoki elektron pochta ko\'ruvchida oldindan ko\'rsangiz, fayl himoyalangan ‚Äî ya\'ni himoyalangan muhitda ishlaydi. Fayllarni mahalliy yuklab olish va ochish ularga tizimingizga ko\'proq kirish imkonini beradi, buni hujumchilar suiiste\'mol qilishlari mumkin.',
                'scenario-title': 'Interaktiv stsenariy: oqilona tanlang',
                'scenario-description': 'Sizga quyidagi sarlavhali elektron xat keldi:',
                'email-title': '"Muhim: Hisob tekshiruvi talab qilinadi"',
                'scenario-question': 'Unda uchta qo\'shimcha bor. Har biri uchun qanday harakat qilasiz?',
                'att1-label': '1-qo\'shimcha:',
                'att1-unsafe': 'Ochish',
                'att1-safe': 'Qochish',
                'att2-label': '2-qo\'shimcha:',
                'att2-safe': 'Faqat oldindan ko\'rish',
                'att2-unsafe': 'Yuklab olish',
                'att3-label': '3-qo\'shimcha:',
                'att3-unsafe': 'O\'rnatish',
                'att3-safe': 'Darhol o\'chirish',
                'btn-prev': 'Oldingi dars',
                'btn-next': 'Keyingi dars',
                'feedback-safe': '‚úÖ Yaxshi tanlov! Har doim ochishdan oldin qo\'shimchalarni tekshiring va xavfsiz ko\'rib chiqing.',
                'feedback-unsafe': '‚ö†Ô∏è Xavfli! Bu fayl zararli dastur yoki fishing mazmunini o\'z ichiga olishi mumkin. Hech qachon shubhali qo\'shimchalarni ochmang.'
            }
        };

        let currentLang = localStorage.getItem('language') || 'en';
        const answeredAttachments = new Set();

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize language buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                if (btn.dataset.lang === currentLang) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            updateLanguage();
            
            initLanguage();
            updateProgress(100);
        });

        function initLanguage() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === currentLang);
            });
            updateLanguage();
        }

        // Language switching
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentLang = btn.dataset.lang;
                localStorage.setItem('language', currentLang);
                updateLanguage();
            });
        });

        function updateLanguage() {
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.dataset.translate;
                if (translations[currentLang][key]) {
                    element.textContent = translations[currentLang][key];
                }
            });
        }

        function updateProgress(percentage) {
            document.getElementById('progressFill').style.width = `${percentage}%`;
            document.getElementById('progressPercentage').textContent = `${percentage}%`;
        }

        function checkAttachment(attNum, isSafe) {
            if (answeredAttachments.has(attNum)) return;

            answeredAttachments.add(attNum);
            const attachmentBox = document.getElementById('att' + attNum);
            const buttons = attachmentBox.querySelectorAll('.attachment-btn');
            const feedback = document.getElementById('feedback' + attNum);

            // Disable buttons
            buttons.forEach(btn => btn.classList.add('disabled'));

            // Show feedback
            if (isSafe) {
                feedback.textContent = translations[currentLang]['feedback-safe'];
                feedback.className = 'feedback show correct';
            } else {
                feedback.textContent = translations[currentLang]['feedback-unsafe'];
                feedback.className = 'feedback show incorrect';
            }
        }
    </script>
</body>
</html>
